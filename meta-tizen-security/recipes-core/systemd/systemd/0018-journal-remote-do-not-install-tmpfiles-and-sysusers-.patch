From 3cc1d5ecdc3f5ec4b1231cb0623ae6a49db3a312 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=C5=81ukasz=20Stelmach?= <l.stelmach@samsung.com>
Date: Tue, 25 Nov 2014 17:01:57 +0100
Subject: [PATCH 18/24] journal-remote: do not install tmpfiles and sysusers
 files by default
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Change-Id: I5cbbcec134f52267ac4841b7d8f14d341a2d2184
Signed-off-by: ≈Åukasz Stelmach <l.stelmach@samsung.com>
Forwarded: http://lists.freedesktop.org/archives/systemd-devel/2014-November/025548.html
---
 Makefile.am | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index 567fd93..b0fb1b9 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -1937,7 +1937,6 @@ nodist_systemunit_DATA += \
 dist_tmpfiles_DATA = \
 	tmpfiles.d/systemd.conf \
 	tmpfiles.d/systemd-nologin.conf \
-	tmpfiles.d/systemd-remote.conf \
 	tmpfiles.d/tmp.conf \
 	tmpfiles.d/x11.conf \
 	tmpfiles.d/var.conf \
@@ -1990,8 +1989,7 @@ SYSINIT_TARGET_WANTS += \
 	systemd-sysusers.service
 
 dist_sysusers_DATA = \
-	sysusers.d/systemd.conf \
-	sysusers.d/systemd-remote.conf
+	sysusers.d/systemd.conf
 
 nodist_sysusers_DATA = \
 	sysusers.d/basic.conf
@@ -3659,6 +3657,16 @@ systemd_journal_remote_CFLAGS = \
 systemd_journal_remote_LDADD += \
 	$(MICROHTTPD_LIBS)
 
+if ENABLE_SYSUSERS
+dist_sysusers_DATA += \
+	sysusers.d/systemd-remote.conf
+endif
+
+if ENABLE_TMPFILES
+dist_tmpfiles_DATA += \
+	tmpfiles.d/systemd-remote.conf
+endif
+
 if HAVE_GNUTLS
 systemd_journal_remote_LDADD += \
 	$(GNUTLS_LIBS)
-- 
1.8.4.5

