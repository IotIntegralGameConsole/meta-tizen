From: Tanu Kaskinen <tanu.kaskinen@linux.intel.com>
Date: Mon, 4 Aug 2014 16:00:01 +0300
Subject: role-ducking: Handle unlinking of uninitialized streams gracefully

There should be no assumptions about what has been initialized when
the unlink hook is fired.

Change-Id: Id3c069093894bf508fbc0be75db046ff875ce965
---
 src/modules/module-role-ducking.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/modules/module-role-ducking.c b/src/modules/module-role-ducking.c
index 9947871..d1ae357 100644
--- a/src/modules/module-role-ducking.c
+++ b/src/modules/module-role-ducking.c
@@ -159,6 +159,9 @@ static pa_hook_result_t process(struct userdata *u, pa_sink_input *i, bool duck)
     pa_assert(u);
     pa_sink_input_assert_ref(i);
 
+    if (!i->proplist)
+        return PA_HOOK_OK;
+
     if (!(role = pa_proplist_gets(i->proplist, PA_PROP_MEDIA_ROLE)))
         return PA_HOOK_OK;
 
