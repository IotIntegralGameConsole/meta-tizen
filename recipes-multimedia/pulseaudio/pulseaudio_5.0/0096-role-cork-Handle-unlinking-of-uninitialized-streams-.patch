From: Tanu Kaskinen <tanu.kaskinen@linux.intel.com>
Date: Mon, 4 Aug 2014 15:59:06 +0300
Subject: role-cork: Handle unlinking of uninitialized streams gracefully

There should be no assumptions about what has been initialized when
the unlink hook is fired.

Change-Id: I4ea4372570e7a0a83c31caab6e2e6781a98cd3ad
---
 src/modules/module-role-cork.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/modules/module-role-cork.c b/src/modules/module-role-cork.c
index 8ca2109..d72350c 100644
--- a/src/modules/module-role-cork.c
+++ b/src/modules/module-role-cork.c
@@ -162,6 +162,9 @@ static pa_hook_result_t process(struct userdata *u, pa_sink_input *i, bool creat
     if (!create)
         pa_hashmap_remove(u->cork_state, i);
 
+    if (!i->proplist)
+        return PA_HOOK_OK;
+
     if (!(role = pa_proplist_gets(i->proplist, PA_PROP_MEDIA_ROLE)))
         return PA_HOOK_OK;
 
