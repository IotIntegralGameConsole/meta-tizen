From: Jaska Uimonen <jaska.uimonen@helsinki.fi>
Date: Tue, 5 Jun 2012 11:36:13 +0300
Subject: build-sys: install files for a module development.

Change-Id: Ib68b292e1f6bc82bb5c148ef53acf51cc571406e
Signed-off-by: Jaska Uimonen <jaska.uimonen@intel.com>
---
 Makefile.am                   | 11 ++++++++++-
 configure.ac                  |  1 +
 pulseaudio-module-devel.pc.in | 12 ++++++++++++
 3 files changed, 23 insertions(+), 1 deletion(-)
 create mode 100644 pulseaudio-module-devel.pc.in

diff --git a/Makefile.am b/Makefile.am
index b0b2553..a6a0b40 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -50,7 +50,13 @@ dist_vapi_DATA = \
 		vala/libpulse-mainloop-glib.deps vala/libpulse-mainloop-glib.vapi
 
 pkgconfigdir = $(libdir)/pkgconfig
-pkgconfig_DATA = libpulse.pc libpulse-simple.pc
+pkgconfig_DATA = libpulse.pc libpulse-simple.pc pulseaudio-module-devel.pc
+
+moduledev_DATA = pulsecore-config.h src/pulsecore/*.h
+moduledevdir   = $(includedir)/pulsemodule/pulsecore
+
+moduledevinternal_DATA = src/pulse/internal.h src/pulse/client-conf.h src/pulse/fork-detect.h
+moduledevinternaldir   = $(includedir)/pulsemodule/pulse
 
 if HAVE_GLIB20
 pkgconfig_DATA += \
@@ -89,6 +95,9 @@ dist-hook:
 check-daemon:
 	$(MAKE) -C src check-daemon
 
+pulsecore-config.h: config.h
+	cp $< $@
+
 .PHONY: homepage distcleancheck doxygen
 
 # see git-version-gen
diff --git a/configure.ac b/configure.ac
index 4854711..4e9f97e 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1384,6 +1384,7 @@ man/default.pa.5.xml
 man/pulse-cli-syntax.5.xml
 man/start-pulseaudio-kde.1.xml
 man/start-pulseaudio-x11.1.xml
+pulseaudio-module-devel.pc
 ])
 
 AC_CONFIG_FILES([src/esdcompat:src/daemon/esdcompat.in], [chmod +x src/esdcompat])
diff --git a/pulseaudio-module-devel.pc.in b/pulseaudio-module-devel.pc.in
new file mode 100644
index 0000000..85aadbc
--- /dev/null
+++ b/pulseaudio-module-devel.pc.in
@@ -0,0 +1,12 @@
+prefix=@prefix@
+exec_prefix=@exec_prefix@
+libdir=@libdir@
+includedir=@includedir@
+modlibexecdir=@modlibexecdir@
+
+Name: pulseaudio-module-devel
+Description: PulseAudio Module Development Interface
+Version: @PACKAGE_VERSION@
+Libs: -L${libdir} -L${libdir}/pulseaudio -L${modlibexecdir} -lpulsecommon-@PA_MAJORMINOR@ -lpulsecore-@PA_MAJORMINOR@ -lprotocol-native
+Libs.private:
+Cflags: -I${includedir}/pulsemodule -D_REENTRANT
